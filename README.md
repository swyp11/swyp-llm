# ì›¨ë”© ë“œë ˆìŠ¤ ì¶”ì²œ API

**AI ê¸°ë°˜ ì›¨ë”© ë“œë ˆìŠ¤ ì¶”ì²œ ì„œë¹„ìŠ¤**

OpenAI GPT-4ë¥¼ í™œìš©í•˜ì—¬ ì‹ ë¶€ì˜ ì²´í˜•ì— ë§ëŠ” ìµœì ì˜ ë“œë ˆìŠ¤ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

### ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client     â”‚ (HTTP)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Layer (FastAPI)               â”‚
â”‚   â””â”€ Routes (recommend, stats)      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Services Layer                    â”‚
â”‚   â”œâ”€ Recommender (AI Logic)         â”‚
â”‚   â””â”€ Schemas (Pydantic)             â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Database  â”‚   Config     â”‚
â”‚   Layer     â”‚   Layer      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Session   â”‚ â€¢ Settings   â”‚
â”‚ â€¢ Models    â”‚ â€¢ Redis      â”‚
â”‚ â€¢ Repos     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    MySQL     â”‚  â”‚    Redis     â”‚
â”‚  (L2 Cache)  â”‚  â”‚  (L1 Cache)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë ˆì´ì–´ ì„¤ëª…

**API Layer** (`src/api/`)
- FastAPI ê¸°ë°˜ REST API
- ìš”ì²­ ê²€ì¦ ë° ì‘ë‹µ í¬ë§·íŒ…
- Routes: recommend, stats

**Services Layer** (`src/services/`)
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (AI ì¶”ì²œ ì—”ì§„)
- Pydantic ìŠ¤í‚¤ë§ˆ ì •ì˜
- ë„ë©”ì¸ ëª¨ë¸

**Database Layer** (`src/database/`)
- SQLAlchemy ì„¸ì…˜ ê´€ë¦¬
- DB ëª¨ë¸ ì •ì˜
- Repository íŒ¨í„´ (ë°ì´í„° ì ‘ê·¼)

**Config Layer** (`src/config/`)
- í™˜ê²½ ì„¤ì • ê´€ë¦¬
- Redis í´ë¼ì´ì–¸íŠ¸

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
wedding-dress-api/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/                      # FastAPI REST API
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI app
â”‚   â”‚   â””â”€â”€ routes/              # API routes
â”‚   â”‚       â”œâ”€â”€ recommend.py     # ë“œë ˆìŠ¤ ì¶”ì²œ ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚       â””â”€â”€ stats.py         # í†µê³„ ì—”ë“œí¬ì¸íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ schemas.py           # Pydantic ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â””â”€â”€ recommender.py       # AI ì¶”ì²œ ì—”ì§„
â”‚   â”‚
â”‚   â”œâ”€â”€ database/                # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ session.py           # DB ì„¸ì…˜
â”‚   â”‚   â”œâ”€â”€ models.py            # SQLAlchemy ëª¨ë¸
â”‚   â”‚   â””â”€â”€ repositories/        # Repository íŒ¨í„´
â”‚   â”‚       â””â”€â”€ recommendation.py
â”‚   â”‚
â”‚   â””â”€â”€ config/                  # ì„¤ì •
â”‚       â”œâ”€â”€ settings.py          # í™˜ê²½ ì„¤ì •
â”‚       â””â”€â”€ redis.py             # Redis í´ë¼ì´ì–¸íŠ¸
â”‚
â”œâ”€â”€ scripts/                     # ìœ í‹¸ë¦¬í‹°
â”‚   â””â”€â”€ init.sql                 # DB ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
â”‚
â”œâ”€â”€ Dockerfile                   # Docker ì´ë¯¸ì§€
â”œâ”€â”€ docker-compose.yaml          # ë¡œì»¬ ê°œë°œ í™˜ê²½
â”œâ”€â”€ requirements.txt             # Python ì˜ì¡´ì„±
â””â”€â”€ README.md
```

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- Python 3.11+
- Docker & Docker Compose
- OpenAI API Key

```bash
# 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
# .env íŒŒì¼ì—ì„œ OPENAI_API_KEYì™€ MYSQL_PASSWORD ì„¤ì •

# 2. ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# 3. ë¡œê·¸ í™•ì¸
docker-compose logs -f api

# 4. í…ŒìŠ¤íŠ¸
curl http://localhost:18000/health
```

## ğŸ“¡ ì‚¬ìš©ë²•

### REST API

**ë“œë ˆìŠ¤ ì¶”ì²œ (ê¸°ë³¸ 3ê°œ)**
```bash
curl -X POST http://localhost:18000/recommend \
  -H "Content-Type: application/json" \
  -d '{
    "arm_length": "ë³´í†µ",
    "leg_length": "ê¸´",
    "neck_length": "ë³´í†µ",
    "face_shape": "ë‹¬ê±€"
  }'
```

**ì¶”ì²œ ê°œìˆ˜ ë³€ê²½ (1-5ê°œ)**
```bash
# 1ê°œë§Œ ì¶”ì²œë°›ê¸°
curl -X POST http://localhost:18000/recommend \
  -H "Content-Type: application/json" \
  -d '{
    "arm_length": "ë³´í†µ",
    "leg_length": "ê¸´",
    "neck_length": "ë³´í†µ",
    "face_shape": "ë‹¬ê±€",
    "num_recommendations": 1
  }'

# 5ê°œ ì¶”ì²œë°›ê¸°
curl -X POST http://localhost:18000/recommend \
  -H "Content-Type: application/json" \
  -d '{
    "arm_length": "ë³´í†µ",
    "leg_length": "ê¸´",
    "neck_length": "ë³´í†µ",
    "face_shape": "ë‹¬ê±€",
    "num_recommendations": 5
  }'
```

**ì‘ë‹µ ì˜ˆì‹œ**
```json
{
  "request_params": {
    "arm_length": "ë³´í†µ",
    "leg_length": "ê¸´",
    "neck_length": "ë³´í†µ",
    "face_shape": "ë‹¬ê±€"
  },
  "recommendations": [
    {
      "style_name": "Aë¼ì¸ ë“œë ˆìŠ¤",
      "description": "ìƒì²´ëŠ” ìŠ¬ë¦¼í•˜ê²Œ, í•˜ì²´ëŠ” í’ì„±í•˜ê²Œ...",
      "why_recommended": "ê¸´ ë‹¤ë¦¬ë¥¼ ë‹ë³´ì´ê²Œ í•˜ë©°...",
      "styling_tips": [
        "í•˜ì´íì„ ì‹ ì–´ ë‹¤ë¦¬ ë¼ì¸ì„ ë”ìš± ê°•ì¡°",
        "ì‹¬í”Œí•œ ëª©ê±¸ì´ë¡œ ì–¼êµ´í˜•ì„ ì‚´ë¦¼"
      ]
    }
  ],
  "overall_advice": "ë‹¬ê±€í˜• ì–¼êµ´ê³¼ ê¸´ ë‹¤ë¦¬ë¥¼ ê°€ì§„ ì‹ ë¶€ë‹˜ê»˜ëŠ”...",
  "cached": false,
  "source": "ai_generated"
}
```

### API ì—”ë“œí¬ì¸íŠ¸

| ë©”ì„œë“œ | ê²½ë¡œ | ì„¤ëª… |
|--------|------|------|
| GET | `/health` | ìƒì„¸ í—¬ìŠ¤ ì²´í¬ |
| POST | `/recommend` | ë“œë ˆìŠ¤ ì¶”ì²œ (ë©”ì¸) |

### ì…ë ¥ íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ì˜µì…˜ | ì¡°í•© |
|---------|------|------|
| arm_length | ì§§ì€, ë³´í†µ, ê¸´ | 3 |
| leg_length | ì§§ì€, ë³´í†µ, ê¸´ | 3 |
| neck_length | ì§§ì€, ë³´í†µ, ê¸´ | 3 |
| face_shape | ë‹¬ê±€, ë„“ì€, ê°ì§„, ê¸´ | 4 |
| num_recommendations | 1, 2, 3, 4, 5 (ê¸°ë³¸ê°’: 3) | 5 |

**ì´ ì¡°í•©**: 3 Ã— 3 Ã— 3 Ã— 4 Ã— 5 = **540ê°€ì§€**

### 2-Tier ìºì‹±

| ë ˆë²¨ | ì €ì¥ì†Œ | ì†ë„ | ìš©ë„ |
|------|--------|------|------|
| L1 | Redis | ~1ms | ì´ˆê³ ì† ì‘ë‹µ |
| L2 | MySQL | ~10ms | ì˜êµ¬ ì €ì¥ + í†µê³„ |

**í”Œë¡œìš°**:
1. Redis Hit â†’ ì¦‰ì‹œ ë°˜í™˜ âœ…
2. Redis Miss â†’ MySQL Hit â†’ Redis ì €ì¥ â†’ ë°˜í™˜
3. MySQL Miss â†’ AI ìƒì„± â†’ ì–‘ìª½ ì €ì¥ â†’ ë°˜í™˜

